webpackJsonp([8],{"9Xwc":function(e,t){},y8T5:function(e,t,a){"use strict";function s(e){a("9Xwc")}Object.defineProperty(t,"__esModule",{value:!0});var i=a("7+uW"),o=a("mvHQ"),r=a.n(o),n=a("Xxa5"),p=a.n(n),d=a("exGp"),u=a.n(d),c=a("r1Vi"),l=a("ZpX4"),g=a("AU0D"),h=a("g5qz"),m=a("3igB"),f=a("KgXo"),v=a("+L+0"),T={name:"App",data:function(){return{headerConfig:{topType:"1",title:"预约到店",showTips:!1,tipsText:"您好，我通常10点-22点在线，非在线时间您可以给我留言"},dateList:[1,2,3,4,5,6,7],flag:0,phoneNumber:"",msg:"",queryAppointInitD:{},queryAppointment:{},starList:[],bookCode:"",bookingTime:"",dataTime:"",modelType:0,guideId:"",channel:"",isYunXin:0,showPage:!1,chid:""}},components:{headerTop:c.a,prompt:l.a,toast:g.a,errorPage:m.a,load:f.a},methods:{confirmPrompt:function(){var e=this;return u()(p.a.mark(function t(){var a,s,i;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=v.a.cancelAppointment,s={bookCode:e.bookCode},e.$refs.load&&e.$refs.load.showToggle(),t.next=6,h.a.ajax({url:a,data:s,type:"get",dataType:"json",timeout:"10000"});case 6:i=t.sent,e.$refs.load&&e.$refs.load.hideToggle(),i.success?e.booking():"6005"==i.errorCode?h.a.h5Toast("今天取消次数已达到上限，请明天再试",e):h.a.h5Toast("哎呀，网络走丢啦~",e),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),e.$refs.load&&e.$refs.load.hideToggle(),h.a.h5Toast("哎呀，网络走丢啦~",e);case 16:case"end":return t.stop()}},t,e,[[0,11]])}))()},configPao:function(){var e=this;return u()(p.a.mark(function t(){var a,s,i,o;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.queryAppointInitD.customerMobile,/^(1[0-9]{1})+\d{9}$/.test(a)||/^1\d{2}\*{4}\d{4}$/.test(a)){t.next=5;break}return e.$refs.load&&e.$refs.load.hideToggle(),h.a.h5Toast("请输入正确联系方式",e),t.abrupt("return");case 5:return t.prev=5,s=v.a.queryAppointment,e.$refs.load&&e.$refs.load.showToggle(),t.next=10,h.a.ajax({url:s,data:{bookingTime:e.bookingTime},type:"get",dataType:"json",timeout:"10000"});case 10:i=t.sent,e.$refs.load&&e.$refs.load.hideToggle(),i.success?(e.queryAppointment=i.data,e.queryAppointment?r()(e.queryAppointment)&&(e.bookCode=e.queryAppointment.bookCode,e.$refs.prompt.showToast=!0,o=e.queryAppointment.bookTime.split(" ")[0].split("-"),e.msg="您已预约"+o[1]+"月"+o[2]+"号到"+(e.queryAppointment.storeName||"门店")+"咨询"+e.queryAppointment.guideName+"，是否改约至"+(e.queryAppointInitD.storeName||"门店")+"咨询"+e.queryAppointInitD.guideName+"？"):i.success?e.booking():e.$refs.toast.autoHide("设置失败",2)):h.a.h5Toast("哎呀，网络走丢啦~",e),t.next=20;break;case 15:t.prev=15,t.t0=t.catch(5),e.$refs.load&&e.$refs.load.hideToggle(),h.a.h5Toast("哎呀，网络走丢啦~",e);case 20:case"end":return t.stop()}},t,e,[[5,15]])}))()},booking:function(){var e=this;return u()(p.a.mark(function t(){var a,s,i,o;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=v.a.booking,s={guideId:e.guideId,customerPhone:e.queryAppointInitD.customerMobile,bookingTime:e.bookingTime,storeCode:e.queryAppointInitD.storeCode,channel:e.channel,storeType:e.queryAppointInitD.businessType},e.$refs.load&&e.$refs.load.showToggle(),t.next=6,h.a.ajax({url:a,data:s,type:"get",dataType:"json",timeout:"10000"});case 6:i=t.sent,e.$refs.load&&e.$refs.load.hideToggle(),i.success?i.success&&(e.$refs.toast.autoHide("预约成功","1"),1==e.isYunXin?(o=e.queryAppointInitD.customerMobile.substring(0,3)+"****"+e.queryAppointInitD.customerMobile.substring(7,11),h.a.invokeYunXin(12,e.dataTime+"|"+o+"|"+i.data),setTimeout(function(){h.a.goBack()},2e3)):setTimeout(function(){if(document.referrer.includes("appointmentDetails")){var t=e.getLastUrlArgs(document.referrer);t.bookCode&&(t.bookCode=i.data);var a="";for(var s in t)a+=s+"="+t[s]+"&";var o=document.referrer.split("?")[0]+"?"+a;location.replace(o)}else location.replace(document.referrer)},2e3)):5011==i.errorCode?h.a.h5Toast("今天已经预约了",e):"vgo_010"==i.errorCode?h.a.h5Toast("亲，12点后不能预约当天哦",e):h.a.h5Toast("哎呀，网络走丢啦~",e),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),e.$refs.load&&e.$refs.load.hideToggle(),h.a.h5Toast("哎呀，网络走丢啦~",e);case 16:case"end":return t.stop()}},t,e,[[0,11]])}))()},getLastUrlArgs:function(e){for(var t=e.split("?")[1],a=t.split("&"),s={},i=void 0,o=void 0,r=void 0,n=void 0,p=0;p<a.length;p++)i=a[p],-1!=(o=i.indexOf("="))&&(r=i.substring(0,o),n=decodeURIComponent(i.substring(o+1)),s[r]=n);return s},queryAppointInit:function(){var e=this;return u()(p.a.mark(function t(){var a,s,i,o,r,n,d,u,c;return p.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,a=v.a.queryAppointInit,s={guideId:e.guideId},e.$refs.load&&e.$refs.load.showToggle(),t.next=6,h.a.ajax({url:a,data:s,type:"get",dataType:"json",timeout:"10000"});case 6:if(i=t.sent,e.$refs.load&&e.$refs.load.hideToggle(),i.success){if(e.queryAppointInitD=i.data,o=e.queryAppointInitD.starLevel,(r=Math.floor(o))<5){for(n=0;n<r;n++)e.starList.push("1");if(o-r>0)for(e.starList.push("2"),d=e.starList.length;d<5;d++)e.starList.push("3");else for(u=e.starList.length;u<5;u++)e.starList.push("3")}else for(c=0;c<5;c++)e.starList.push("1");e.setDateStr(e.queryAppointInitD.initTime),e.showPage=!0}else e.showPage=!0,h.a.h5Toast("哎呀，网络走丢啦~",e);t.next=17;break;case 11:t.prev=11,t.t0=t.catch(0),e.showPage=!0,e.$refs.load&&e.$refs.load.hideToggle(),h.a.h5Toast("哎呀，网络走丢啦~",e);case 17:case"end":return t.stop()}},t,e,[[0,11]])}))()},setDateStr:function(e){this.dateList=[];for(var t=["星期天","星期一","星期二","星期三","星期四","星期五","星期六"],a=0;a<7;a++){var s={},i=e.replace(/\-/g,"/"),o=new Date(i);o.getHours()>12?o.setDate(o.getDate()+(a+1)):o.setDate(o.getDate()+a);var r=o.getMonth()+1,n=o.getDate()<10?"0"+o.getDate():o.getDate();s.year=o.getFullYear(),s.dateTime=r+"-"+n,r<10&&(r="0"+r),s.curData=r+"-"+n,0==a?o.getHours()>12?s.week="明天":s.week="今天":s.week=t[o.getDay()],this.dateList.push(s)}this.bookingTime=this.dateList[0].year+"-"+this.dateList[0].curData,this.dataTime=this.dateList[0].dateTime+" "+this.dateList[0].week},setBackground:function(e){this.bookingTime=this.dateList[e].year+"-"+this.dateList[e].curData,this.dataTime=this.dateList[e].dateTime+" "+this.dateList[e].week,this.flag=e},quickAppoint:function(){this.$refs.toast.autoHide("预约失败",2)}},created:function(){window.modelType=h.a.modelType(),this.modelType=window.modelType,this.chid=h.a.chidValue();var e=h.a.getUrlArgs();this.guideId=e.guideId||"",this.channel=e.channel||"",this.isYunXin=e.isYunxin||0},mounted:function(){this.queryAppointInit(),h.a.checkWorkingTime()?this.headerConfig.showTips=!0:this.headerConfig.showTips=!1}},y=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[3==e.modelType?[s("error-page")]:3!=e.modelType?[s("header-top",{attrs:{headerConfig:e.headerConfig}}),e._v(" "),e.showPage?[s("div",{staticClass:"appointGuide"},[s("div",{staticClass:"bgc-box"}),e._v(" "),s("div",{staticClass:"guideInfoBox"},[s("div",{staticClass:"info_top"},[s("div",{staticClass:"head_img"},[s("img",{attrs:{src:e.queryAppointInitD.guidePhoto,width:"100%",height:"100%"}})]),e._v(" "),s("div",{staticClass:"detailInfo"},[s("p",{staticClass:"name"},[e._v(e._s(e.queryAppointInitD.guideName)+" "),s("img",{staticClass:"storeType",attrs:{src:a(1==e.queryAppointInitD.businessType?"sJSZ":"vZbn"),alt:""}})]),e._v(" "),s("div",{staticClass:"starBox"},[s("div",{staticClass:"starLevel"},e._l(e.starList,function(e,t){return s("div",{key:t,class:"star"+e})})),e._v(" "),s("p",{staticClass:"score"},[e._v(e._s(e.queryAppointInitD.starGrade)+"分")])])])]),e._v(" "),s("div",{staticClass:"info_bottom"},[s("div",{staticClass:"store"},[s("span",{staticClass:"title"},[e._v("所属门店：")]),e._v(" "),s("span",{staticClass:"message"},[e._v(e._s(e.queryAppointInitD.storeName))])]),e._v(" "),s("div",{staticClass:"address"},[s("span",{staticClass:"title"},[e._v("门店地址：")]),e._v(" "),s("span",{staticClass:"message"},[e._v(e._s(e.queryAppointInitD.storeAddress))])])])])]),e._v(" "),s("div",{staticClass:"appointInfoBox"},[s("p",{staticClass:"storeTitle"},[e._v("选择到店时间")]),e._v(" "),s("ul",{staticClass:"clearfix"},e._l(e.dateList,function(t,a){return s("li",{directives:[{name:"tap",rawName:"v-tap",value:function(){return e.setBackground(a)},expression:"()=>setBackground(index)"}],key:a,class:["dateBox",{bgc:a==e.flag}]},[s("p",{staticClass:"date"},[e._v(e._s(t.dateTime))]),e._v(" "),s("p",{staticClass:"week"},[e._v(e._s(t.week))])])})),e._v(" "),s("p",{staticClass:"phone"},[e._v("手机号码")]),e._v(" "),s("p",{staticClass:"prompt"},[e._v("预约后导购员会对该号码进行回访")]),e._v(" "),s("input",{directives:[{name:"model",rawName:"v-model",value:e.queryAppointInitD.customerMobile,expression:"queryAppointInitD.customerMobile"}],staticClass:"number",attrs:{type:"text"},domProps:{value:e.queryAppointInitD.customerMobile},on:{input:function(t){t.target.composing||e.$set(e.queryAppointInitD,"customerMobile",t.target.value)}}})]),e._v(" "),s("a",{directives:[{name:"tap",rawName:"v-tap",value:e.configPao,expression:"configPao"}],staticClass:"reservation"},[e._v("\n        立即预约\n      ")])]:e._e(),e._v(" "),s("prompt",{ref:"prompt",attrs:{confirmBtnText:"改约",text:e.msg},on:{confirm:e.confirmPrompt}}),e._v(" "),s("toast",{ref:"toast"}),e._v(" "),s("load",{ref:"load"}),e._v(" "),s("input",{attrs:{type:"hidden",id:"resourceType",value:"4k3"}}),e._v(" "),s("input",{attrs:{type:"hidden",id:"pagename"},domProps:{value:"pgtitle=预约详情页;lgid="+e.guideId+";ctid="+e.cityId+";actid=a0002;chid="+e.chid}})]:e._e()],2)},_=[],b={render:y,staticRenderFns:_},k=b,C=a("VU/8"),A=s,w=C(T,k,!1,A,null,null),D=w.exports;a("sVYa");i.a.config.productionTip=!1,new i.a({el:"#app",components:{appointmentStore:D},template:"<appointmentStore/>"})}},["y8T5"]);