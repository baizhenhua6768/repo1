<?xml version="1.0" encoding="UTF-8" ?>
<sqlMap namespace="guideOrderLog" jdbcTimeout="5">

    <sql id="updateOrderStatusFlag">
        <![CDATA[
            UPDATE o2o_guide_order_log
            SET ORDER_STATUS_FLAG = 0
            WHERE ORDER_STATUS = 1 AND BOOKCODE = :guideOrderLog.bookCode
            <#if guideId?exists && guideId!=""> AND GUIDE_ID = :guideOrderLog.guideId </#if>
            <#if custNumber?exists && custNumber!=""> AND CUST_NUMBER = :guideOrderLog.custNumber </#if>
    	]]>
    </sql>

    <sql id="queryGuideOrderLog">
        <![CDATA[
            select
                ORDER_LOG_ID as orderLogId,
                BOOKCODE as bookCode,
                CUST_NUMBER as custNumber,
                GUIDE_ID as guideId,
                ORDER_STATUS as orderStatus,
                ORDER_STATUS_FLAG as orderStatusFlag,
                CREATE_FLAG as createFlag,
                CREATE_TIME as createTime
            from
                o2o_guide_order_log
            where
                BOOKCODE = :bookCode
            ORDER BY CREATE_TIME desc
    	]]>
    </sql>

</sqlMap>